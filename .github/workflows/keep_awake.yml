name: Keep Hugging Face Space Awake

on:
  schedule:
    # Run daily at midnight UTC
    - cron: '0 0 * * *'
  # Allow manual trigger for testing
  workflow_dispatch:

permissions:
  contents: write  # Needed to push the keepalive commit to this repo

jobs:
  ping_and_keepalive:
    runs-on: ubuntu-latest
    steps:
      # Step 1: Wake up the Space (using your specific URLs)
      - name: Ping HF Space
        run: |
          # 1. Ping the main Hugging Face page
          curl -I https://huggingface.co/spaces/keola1001/ICD-Detector
          
          # 2. Ping the direct app embed (forces the container to spin up)
          # Note: HF automatically lowercases the URL for direct access
          curl -I https://keola1001-icd-detector.hf.space

      # Step 2: Checkout code (needed for the keepalive action)
      - name: Checkout code
        uses: actions/checkout@v3

      # Step 3: Prevent GitHub from disabling this workflow after 60 days
      - name: Keepalive Workflow
        uses: gautamkrishnar/keepalive-workflow@v2
        with:
          # This forces a dummy commit every 50 days so GitHub sees "activity"
          commit_message: "Automated keepalive [skip ci]"
          time_elapsed: 50
